# Results  Simulations Multiple Environments


```{r }


    namesRealEnv=c("epica","lr04","ls16","vostok","ngrip","martrat")
    namesFun=c("getMean","getLast","getFirst")

    allEs=c(0.2,.6,1)
    allSigmas=c(1,2)
    #for(env in namesRealEnv){
    #    #cat(paste0("  \n\r## ",env), sep="")
    #    for(fun in namesFun){
    #        folderexpe=paste0(env,fun)
    #        idexpe=folderexpe

    #        ns=length(list.files(path=folderexpe,recursive=T,full.names=T,pattern="*cross*"))
    #        binded=do.call("rbind",lapply(list.files(path=folderexpe,recursive=T,full.names=T,pattern="*cross*"),function(u){load(u);return(binded)}))
    #        allEs=unique(binded$E)
    #        allSigmas=unique(binded$sigma)
    #        load(file=as.character(binded$filename[1]))
    #        steps=nrow(summary)

    #        t=c("NA","N","3Genes")
    #        allsummaries=unlist(lapply(allSigmas,function(s)paste0('images/',idexpe,t,'_sigma',s,'_E.png')))

    #        #cat(paste0("  \n\r### Last step Summary",fun), sep="")

    #        knitr::include_graphics(as.character(allsummaries))

    #        #cat("  \n")

    #        #cat(paste0("  \n\r### Traj Summary ",fun), sep="") allimg=unlist(lapply(allSigmas,function(s)paste0("images/vertical_",idexpe,"_sigma",s,"_E",allEs,".png"))) knitr::include_graphics(as.character(allimg))
    #        #cat("  \n")

    #        #cat(paste0("  \n\r### Vertical Summary Indiv ",fun), sep="")
    #        allimg=unlist(lapply(allSigmas,function(s)paste0("images/verticalM_",idexpe,"_sigma",s,"_E",allEs,".png")))
    #        knitr::include_graphics(as.character(allimg))
    #        #cat("  \n")
    #    }
    #        #cat("  \n")
    #}


```

```{r}
      #"## {{env}}",

a=c(
    "### Function {{fun}}",
    '```{r}',
    'idexpe="{{id}}"',
    't=c("NA","N","3Genes")',
    'allsummaries=unlist(lapply(allSigmas,function(s)paste0("images/",idexpe,t,"_sigma",s,"_E.png")))',
    '```',
    "#### Last step summary",
    paste0('```{r summary-last-{{id}}, out.width = "33%", fig.cap="Summary output for last step, from top to bottom  $\\\\sigma_s =',paste0(allSigmas, collapse = ","),'$, from left to right: number of extinction, mean population size and mean genotype at the end of the simulation. Environment:{{env}}, subsampling function:{{fun}}",fig.show="hold",fig.link=allsummaries}'),
    'knitr::include_graphics(as.character(allsummaries))',
    '```',
    '```{r}',
    'allimg=unlist(lapply(allSigmas,function(s)paste0("images/vertical_",idexpe,"_sigma",s,"_E",allEs,".png")))',
    '```',
    "#### Vertical summary",
    paste0('```{r traj-summary-{{id}}, out.width = "33%", fig.cap="Summarized vertical trajectories (from top to bottom $\\\\sigma_s =',paste0(allSigmas, collapse = ","),'$, from left to right, $E=',paste0(allEs, collapse = ","),'$). Environment:{{env}}, subsampling function:{{fun}}",fig.show="hold",fig.link=allimg}'),
    'knitr::include_graphics(as.character(allimg))',
    '```',
    '```{r}',
    'allimg=unlist(lapply(allSigmas,function(s)paste0("images/verticalM_",idexpe,"_sigma",s,"_E",allEs,".png")))',
    '```',
    "#### Vertical run indiv",
    paste0('```{r traj-indv-{{id}}, out.width = "33%", fig.cap="Vertical trajectories for 20 individual runs (from top to bottom $\\\\sigma_s =',paste0(allSigmas, collapse = ","),'$, from left to right, $E=',paste0(allEs, collapse = ","),'$). Environment:{{env}}, subsampling function:{{fun}}",fig.show="hold",fig.link=allimg}'),
    'idexpe="{{id}}"',
    'knitr::include_graphics(as.character(allimg))',
    '```'
    )

```

```{r,include=FALSE,echo=T}
src <- lapply(namesRealEnv,function(env)c(knitr::knit_expand(text="## {{env}}",env=env),lapply(namesFun,function(fun)knitr::knit_expand(text=a,id=paste0(env,fun),env=env,fun=fun))))

```

`r knitr::knit(text=unlist(src))`
