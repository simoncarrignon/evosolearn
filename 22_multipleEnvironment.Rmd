# Simulations Multiple Environmens


```{r }


    namesRealEnv=c("epica","lr04","ls16","vostok")
    namesFun=c("getMean","getLast","getFirst")

    for(env in namesRealEnv){
        #cat(paste0("  \n\r## ",env), sep="")
        for(fun in namesFun){
            folderexpe=paste0(env,fun)
            idexpe=folderexpe

    ns=length(list.files(path=folderexpe,recursive=T,full.names=T,pattern="*cross*"))
    binded=do.call("rbind",lapply(list.files(path=folderexpe,recursive=T,full.names=T,pattern="*cross*"),function(u){load(u);return(binded)}))
    allEs=unique(binded$E)
    allSigmas=unique(binded$sigma)
    load(file=as.character(binded$filename[1]))
    steps=nrow(summary)

            t=c("NA","N","3Genes")
            allsummaries=unlist(lapply(allSigmas,function(s)paste0('images/',idexpe,t,'_sigma',s,'_E.png')))

            #cat(paste0("  \n\r### Last step Summary",fun), sep="")

            knitr::include_graphics(as.character(allsummaries))

            #cat("  \n")

            #cat(paste0("  \n\r### Traj Summary ",fun), sep="") allimg=unlist(lapply(allSigmas,function(s)paste0("images/vertical_",idexpe,"_sigma",s,"_E",allEs,".png"))) knitr::include_graphics(as.character(allimg))
            #cat("  \n")

            #cat(paste0("  \n\r### Vertical Summary Indiv ",fun), sep="")
            allimg=unlist(lapply(allSigmas,function(s)paste0("images/verticalM_",idexpe,"_sigma",s,"_E",allEs,".png")))
            knitr::include_graphics(as.character(allimg))
            #cat("  \n")
        }
            #cat("  \n")
    }


```

```{r}
      #"## {{env}}",
      #"### Function {{fun}}",

a=c(
    '```{r summary-last-{{id}}, out.width = "33%", fig.cap="Summary output for last step, from top to bottom  $\\\\sigma_s = 0.5,1$, from left to right: number of extinction, mean population size and mean genotype at the end of the simulation. Environment:{{env}}, subsampling function:{{fun}}",fig.show="hold"}',
    'idexpe="{{id}}"',
    't=c("NA","N","3Genes")',
    'allsummaries=unlist(lapply(allSigmas,function(s)paste0("images/",idexpe,t,"_sigma",s,"_E.png")))',
    'knitr::include_graphics(as.character(allsummaries))',
    '```',
    '```{r traj-summary-{{id}}, out.width = "33%", fig.cap="Summarized vertical trajectories (from top to bottom $\\\\sigma_s = 0.5,1$, from left to right, $E=0.2,0.6,1$)",fig.show="hold"}',
    'idexpe="{{id}}"',
    'allimg=unlist(lapply(allSigmas,function(s)paste0("images/vertical_",idexpe,"_sigma",s,"_E",allEs,".png")))',
    'knitr::include_graphics(as.character(allimg))',
    '```',
    '```{r traj-indv-{{id}}, out.width = "33%", fig.cap="Vertical trajectories for 20 individual runs (from top to bottom $\\\\sigma_s = 0.5,1$, from left to right, $E=0.2,0.6,1$)",fig.show="hold"}',
    'idexpe="{{id}}"',
    'allimg=unlist(lapply(allSigmas,function(s)paste0("images/verticalM_",idexpe,"_sigma",s,"_E",allEs,".png")))',
    'knitr::include_graphics(as.character(allimg))',
    '```'
    )

```

```{r,include=FALSE,echo=T}
src <- lapply(namesRealEnv,function(env)lapply(namesFun,function(fun)knitr::knit_expand(text=a,id=paste0(env,fun),env=env,fun=fun)))

```

`r knitr::knit(text=unlist(src))`
