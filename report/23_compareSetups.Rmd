# Compare Different Setups

## Compare different environment:

```{r}
listimage=c(
"images/verticallimited_martratinterpolate_LinFALSERes20RANDOM_sigma2_E0.6.png",
"images/verticallimited_vostokinterpolate_LinTRUERes20SlsrandomBIS_sigma2_E0.6.png",
"images/vertical_ngrip2interpolate_LinTRUERes20RANDOM_sigma2_E0.6.png",
"images/martratinterpolate_LinFALSERes20BEST3Genes_sigma2_E.png",
"images/vostokinterpolate_LinTRUERes20SlsrandomBIS3Genes_sigma2_E.png",
"images/ngrip2interpolate_LinTRUERes20RANDOM3Genes_sigma2_E.png"
)
```

We compare output simulation with vostok, ngrip2 and martrat
```{r out.width="33%",fig.show="hold",fig.cap="rescaled simulation for martrat(left) vostok (middle) and ngrip2 (right) with random social learning",fig.link=listimage}
    knitr::include_graphics(listimage)
```
```{r}
listimage=c(
"images/vertical_martratinterpolate_LinFALSERes20RANDOM_sigma2_E0.6.png",
"images/vertical_vostokinterpolate_LinTRUERes20SlsrandomBIS_sigma2_E0.6.png"
)
```

We compare output simulation with vostok, ngrip2 and martrat
```{r out.width="50%",fig.show="hold",fig.cap="martrat(left) vostok (right) full simulations",fig.link=listimage}
    knitr::include_graphics(listimage)
```


## Compare different interpolation:
```{r}
listimage=c(
"images/vertical_vostokinterpolate_LinTRUERes20SlsrandomBIS_sigma2_E0.6.png",
"images/vertical_vostokinterpolate_LinTRUERes20SlsrandomTRIS_sigma2_E0.6.png",
"images/vertical_vostokinterpolate_LinTRUERes20SlsrandomQUIS_sigma2_E0.6.png",
"images/vertical_vostokinterpolate_SlsrandomNEW_sigma2_E0.6.png",
"images/vertical_vostokinterpolate_SlsrandomNEW_sigma3_E0.6.png",
"images/verticalM_vostokinterpolate_SlsrandomNEW_sigma3_E0.6.png",
"images/verticalMy_vostokinterpolate_SlsrandomNEW_sigma3_E0.6.png",
"images/verticalMz_vostokinterpolate_SlsrandomNEW_sigma3_E0.6.png",
"images/vertical_vostokinterpolate_SlsbestNEW_sigma2_E0.6.png",
"images/vertical_vostokinterpolate_SlsbestNEW_sigma3_E0.6.png",
"images/verticalM_vostokinterpolate_SlsbestNEW_sigma3_E0.6.png",
"images/verticalMy_vostokinterpolate_SlsbestNEW_sigma3_E0.6.png",
"images/verticalMz_vostokinterpolate_SlsbestNEW_sigma3_E0.6.png",
"images/vertical_lr04interpolate_SlsrandomNEW_sigma2_E0.6.png",
"images/vertical_lr04interpolate_SlsrandomNEW_sigma3_E0.6.png",
"images/verticalM_lr04interpolate_SlsrandomNEW_sigma3_E0.6.png",
"images/verticalMy_lr04interpolate_SlsrandomNEW_sigma3_E0.6.png",
"images/verticalMz_lr04interpolate_SlsrandomNEW_sigma3_E0.6.png",
"images/vertical_lr04interpolate_SlsbestNEW_sigma2_E0.6.png",
"images/vertical_lr04interpolate_SlsbestNEW_sigma3_E0.6.png",
"images/verticalM_lr04interpolate_SlsbestNEW_sigma3_E0.6.png",
"images/verticalMy_lr04interpolate_SlsbestNEW_sigma3_E0.6.png",
"images/verticalMz_lr04interpolate_SlsbestNEW_sigma3_E0.6.png"
)
```

We compare output simulation with vostok, for different $\omega$ for the noise added. 
```{r out.width="33%",fig.show="hold",fig.cap="vostok with inperpolation computed with different $\\omega$ (from left to right: $\\omega$ = 1,1.41,1.81)",fig.link=listimage}
    knitr::include_graphics(listimage)
```


## Summary statistic and distance to expected outcome

To simplify the exploration of the parameter space we design a function that compute a distance between the simulation and an expected ideal output. This function shoul d allow us to compute the combination parameters that are more likely to generate our expected output. Then we can test if these probability are impacted by various assumption made while running simulation (type of social learning, slope and variation of the simulated noise,...).

We define $e$ the output generated by one combination of parameters $\theta$. This $e$ can be any element of our simulation. For now we use as output a matrix $t\times 3$ representing the mean value in the population for the three genes $x,y,z$ during the $t$th last time steps. 

$F=1-\frac{|e_z-0.05|}{\sqrt{|e_z^2-0.05^2|]}}$ if $e_z\neq0.05$, $F=1$ else.

F looks like:


```{r}
x=seq(0,1,by=0.001)
plot(x,distT(x,0.05),xlab="x",ylab="F(x)")
abline(v=0.05,col="red")
```


$$ s=\left(1-\frac{|e_z-0.05|}{\sqrt{|e_z^2-0.05^2|]}}\right) + sd(e_y) + sd(e_z) $$
$$ s=F + sd(e_y) + sd(e_z) $$



```{r}
listimage=c(
"images/distScore_sigma1_E.png",
"images/distScore_sigma2_E.png",
"images/posteriorE.png",
"images/posteriorKZ.png",
"images/posteriorKY.png"
)
```

We can then analysis the influence of our different parameters on the score
```{r out.width="33%",fig.show="hold",fig.cap="First row distribution of s given differen parameter combination,bottom row, marginal distribution given $E$ and $k_y$", fig.link=listimage}
    knitr::include_graphics(listimage)
```



